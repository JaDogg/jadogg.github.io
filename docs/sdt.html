<!doctypehtml><html lang="en"><meta charset="utf-8"><title>Bhathiya&#x27;s Site 😸</title><link rel="apple-touch-icon"sizes="180x180"href="/apple-touch-icon.png"><link rel="icon"type="image/png"sizes="32x32"href="/favicon-32x32.png"><link rel="icon"type="image/png"sizes="16x16"href="/favicon-16x16.png"><link rel="manifest"href="/site.webmanifest"><link rel="mask-icon"href="/safari-pinned-tab.svg"color="#5bbad5"><meta name="msapplication-TileColor"content="#da532c"><meta name="theme-color"content="#ffffff"><meta name="description"content="Bhathiya&#x27;s Site 😸"><meta name="viewport"content="width=device-width,initial-scale=1"><link rel="preconnect"href="https://fonts.googleapis.com"><link rel="preconnect"href="https://fonts.gstatic.com"crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@200&display=swap"rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@500&display=swap"rel="stylesheet"><link rel="stylesheet"href="/assets/style.min.css"id="theme-link"><div class="container"><h1 class="center-text">Bhathiya&#x27;s Site 😸</h1><div class="table-of-contents"><p>Pages<nav><a href="/">Home</a></nav><button id="btn-toggle"class="button action-button"><svg xmlns="http://www.w3.org/2000/svg"width="32"height="32"fill="currentColor"class="bi bi-brightness-high"viewBox="0 0 16 16"><path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/></svg></button><div>&nbsp;</div><p>Projects</p><a href="/yaksha.html">YakshaLang</a> | <a href="/sdt.html">SystemDesignToolkit</a> | <a href="/docbox.html">DocBox</a><div class="real-toc"><div>&nbsp;</div><p>Table of Content<div class="toc-item"><a href="#introduction">[1] Introduction</a></div><div class="toc-item"><a href="#usage-samples">[2] Usage Samples</a></div><div class="toc-item"><a href="#tinder-system-design">[2.1] Tinder System Design</a></div><div class="toc-item"><a href="#how-to-find-people-close-to-you">[2.1.1] How to find people close to you?</a></div><div class="toc-item"><a href="#quad-tree">[2.1.1.1] Quad Tree</a></div><div class="toc-item"><a href="#querying-nearby-people">[2.1.1.2] Querying nearby people</a></div><div class="toc-item"><a href="#geo-sharding">[2.1.1.3] Geo-sharding</a></div><div class="toc-item"><a href="#matching-and-likes">[2.1.1.4] Matching and likes</a></div><div class="toc-item"><a href="#rest-of-the-system">[2.1.2] Rest of the system</a></div><div class="toc-item"><a href="#authentication-and-security">[2.1.2.1] Authentication and security</a></div><div class="toc-item"><a href="#storing-images">[2.1.2.2] Storing images</a></div><div class="toc-item"><a href="#caches-and-power-law-distribution">[2.1.2.2.1] Caches and power law distribution</a></div><div class="toc-item"><a href="#image-formats">[2.1.2.2.2] Image formats</a></div><div class="toc-item"><a href="#bibliography-for-tinder-system-design">[2.1.3] Bibliography for Tinder system design</a></div><div class="toc-item"><a href="#leetcode-hacker-rank-system-design">[2.2] Leetcode / Hacker rank system design</a></div><div class="toc-item"><a href="#code-execution">[2.2.1] Code execution</a></div><div class="toc-item"><a href="#solution-a-docker-containers-on-lambdas-serverless">[2.2.1.1] Solution A: Docker containers on lambdas (serverless)</a></div><div class="toc-item"><a href="#solution-b-servers-that-take-work-from-a-queue-spin-up-docker-containers">[2.2.1.2] Solution B: Servers that take work from a queue spin up docker containers</a></div><div class="toc-item"><a href="#plagiarism-detection">[2.2.2] Plagiarism detection</a></div><div class="toc-item"><a href="#different-forms-of-cheating">[2.2.2.1] Different forms of cheating</a></div><div class="toc-item"><a href="#cheat-detection-process">[2.2.2.2] Cheat detection process</a></div><div class="toc-item"><a href="#solution-a-lambdas-with-step-function-execution">[2.2.2.2.1] Solution A: Lambdas with step function execution</a></div><div class="toc-item"><a href="#solution-b-coordinated-work-in-static-number-of-nodes">[2.2.2.2.2] Solution B: Coordinated work in static number of nodes</a></div><div class="toc-item"><a href="#bibliography-for-leetcode-design">[2.2.3] Bibliography for Leetcode design</a></div><div class="toc-item"><a href="#subsystems-and-utility-systems-samples">[3] Subsystems and utility systems samples</a></div><div class="toc-item"><a href="#vm-cluster">[3.1] VM Cluster</a></div><div class="toc-item"><a href="#lambdas-on-top-of-vm-cluster">[3.2] Lambdas on top of VM Cluster</a></div><div class="toc-item"><a href="#distributed-queue">[3.3] Distributed queue</a></div><div class="toc-item"><a href="#single-node-queue-implementation">[3.3.1] Single node queue implementation</a></div><div class="toc-item"><a href="#multi-node-implementation">[3.3.2] Multi-node implementation</a></div><div class="toc-item"><a href="#distributed-monitoring-and-paging">[3.4] Distributed monitoring and paging</a></div><div class="toc-item"><a href="#distributed-storage-file-system">[3.5] Distributed storage / file system</a></div><div class="toc-item"><a href="#in-memory-cache">[3.6] In memory cache</a></div><div class="toc-item"><a href="#components">[4] Components</a></div><div class="toc-item"><a href="#services-and-related-components">[4.1] Services and related components</a></div><div class="toc-item"><a href="#service">[4.1.1] Service</a></div><div class="toc-item"><a href="#algorithms-and-data-structures">[4.2] Algorithms and data structures</a></div><div class="toc-item"><a href="#quad-tree">[4.2.1] Quad tree</a></div><div class="toc-item"><a href="#utilities">[4.3] Utilities</a></div><div class="toc-item"><a href="#pros-cons-box">[4.3.1] Pros-Cons Box</a></div></div></div><div class="boxes"><hr><div class="box"><div class="content"><div class="banner-image"><img alt="System Design Toolkit"src="images/system-design-tooklit-banner.png"style="max-width:100%"></div></div><div class="note"></div></div><div class="box"><div class="content"><h2 id="introduction">[1] Introduction</h2></div><div class="note"></div></div><div class="box"><div class="content"><p>I got an idea to come up with set of reusable (technology oblivious) building blocks for system design. Main point is you can either use it diagrams.net (or desktop version), whiteboard or any other tool you like. I use it myself and there's no reason for people other than me to use it. I'm designing this backwards from system design diagrams, so I will come up with multiple system designs and extract common components. Any form of constructive criticism is appreciated as usual.</div><div class="note"><p>🤔 Disagreeing for the sake of it is bad, cargo-culting is bad, somewhere middle is probably zen. - Me.</div></div><div class="box"><div class="content"><hr><h2 id="usage-samples">[2] Usage Samples</h2></div><div class="note"><hr></div></div><div class="box"><div class="content"><p>For usage examples I am planning on trying few system designs of well-known software that anyone would be aware of. I'll be diving as deep as I think is necessary to explain my design here. By making myself come up with these designs I achieve two things. First of all, I get to see what kind of common components are present in these system designs. I also get to publicly practice system design and expose myself to criticism.</div><div class="note"><p>Hopefully constructive criticism.</div></div><div class="box"><div class="content"><hr><h3 id="tinder-system-design">[2.1] Tinder System Design</h3></div><div class="note"><hr></div></div><div class="box"><div class="content"><a href="images/system-design-tinder.png"target="_blank"rel="noopener noreferrer"><img alt="Tinder Design, contain a diagram with arrows pointing to services"src="images/system-design-tinder.png"style="max-width:100%"></a></div><div class="note"><p>I'm up for suggestions. If you got an idea let me know.<p><span class="yellow-status">in progress</span></div></div><div class="box"><div class="content"><h4 id="how-to-find-people-close-to-you">[2.1.1] How to find people close to you?</h4><p>Main crux of this design is to find a suitable methodology to find people close to you.<ul><li><p>We can use Google S3 or Uber H3 - Both are ready-made libraries for this task.<li><p>We can use geo-hash prefix matching. This is a human-readable format, and you can easily look at two hashes and if they are closer based on the prefix.<li><p>Creating our own library - quad tree.</ul><h5 id="quad-tree">[2.1.1.1] Quad Tree</h5><p>This is an important data structure that we can use if we want to come up with this ourselves. Think of this as a structure that allows you to break down a square to four small squares, and you can keep going until it is very small. Internally it is a tree with 4 children.</p><img alt="3 Squares with quad-tree breakdown"src="images/sdt-quad-tree.png"style="max-width:100%"></div><div class="note"></div></div><div class="box"><div class="content"><h5 id="querying-nearby-people">[2.1.1.2] Querying nearby people</h5><p>In above design we assumed that we use can find nearby users by simply looking at the profile database. However, we did not dive deep into what we need to ensure that we properly distribute profile data so we do not brown out a single node.</div><div class="note"></div></div><div class="box"><div class="content"><h5 id="geo-sharding">[2.1.1.3] Geo-sharding</h5><p>Geo sharding is a concept where we map roughly similar user count regions of the world in to different shards of the database. This is a load balancing mechanism and a way to avoid querying a lot of nodes and wasting time. As explained in Tinder blog posts they came up with shards by experimenting and finding out which number of shards and how it was distributed resulted in good p50, p90 and p99 latency metrics. Example - London can be placed in one geo-shard while most of the Australian desert can also be placed in a single geo-shard. So the actual number of users would impact this rather than surface area on Earth.</div><div class="note"><p>Geo-sharding is a form of load balancing.</div></div><div class="box"><div class="content"><h5 id="matching-and-likes">[2.1.1.4] Matching and likes</h5><p>For this I'm thinking we can use a queue and set of serverless functions/lambdas to process incoming likes and write that to a database/cache. And we can use another set of lambdas to turn matches to notifications.</div><div class="note"><p>System that can spin up on-demand functions and distributed queues are (sub)systems of this system.</div></div><div class="box"><div class="content"><h4 id="rest-of-the-system">[2.1.2] Rest of the system</h4></div><div class="note"></div></div><div class="box"><div class="content"><h5 id="authentication-and-security">[2.1.2.1] Authentication and security</h5><p>For a secure system we need to consider <code>AAA</code> (Authentication , Authorization, and Accounting). However, there is no need to do implement a <code>RBAC</code> (Role-based access control) for end-users of the system. They will all be able to log-in to their own account and use the application. <code>RBAC</code> and full <code>AAA</code> is however important for internal teams and any admin applications used internally.<p>So from system design perspective something like eventual consistency does not make sense for passwords. Passwords themselves we cannot store in a database like you would with any other data.<ul><li><p>OWASP recommend <code>Argon2id</code> these days (<code>scrypt</code> and <code>PBKDF2-HMAC-SHA512</code> with <code>120k</code> iterations is also sufficient).<li><p>We can also use <code>peppering</code> for further security.<li><p>Another alternative is to sign in using email and never store any passwords.<li><p>It is also better to avoid coming up with own cryptographical algorithms.<li><p>It is perfectly fine to write it yourself for everything else. Having too many dependencies open yourself up to a lot of vulnerabilities.</ul><p>Getting back to why not eventual consistency, it is because if you change the password - It needs either successfully change everywhere or not change at all. This disallows a bad actor to luck into the system.</div><div class="note"><p>We can design authentication as a system as well.</div></div><div class="box"><div class="content"><h5 id="storing-images">[2.1.2.2] Storing images</h5><p>For a service such as Tinder images are essential. However, images are not required to find nearby users. It is however essential for users to see other users' images. Therefore, we can use on-disk storage for images and have a reference to it in our profile database. So, when a user browses a profile we can get request these images on demand. It makes sense to use a distributed file system.</div><div class="note"><p><code>DFS</code> (Distributed file system) is a (sub)system that we use in this system.</div></div><div class="box"><div class="content"><h6 id="caches-and-power-law-distribution">[2.1.2.2.1] Caches and power law distribution</h6><p>Caches or in this case specifically a <code>CDN</code> (Content delivery network) which is also another system on its own can help us scale with the load to access these user images. Let's think of celebrity situation, suddenly a recently divorced famous actor/actress creates a Tinder account. Now everyone wants to look at their images and swipe (whatever side for like). This is a good use-case for a <code>CDN</code> as these celebrity images are now cached.<p>Since the number of requests for an account is distributed in a power law distribution due to pareto principle. We can assume that the CDN can use a <code>LRU</code> (Least recently used) cache eviction mechanism. This way most recently used image will be kept hot in the cache.</div><div class="note"><p>Likes, Money and Followers this all work in a power law distribution, those who have more will always get more.</div></div><div class="box"><div class="content"><h6 id="image-formats">[2.1.2.2.2] Image formats</h6><p>Thumbnails for images is essential, and we can use a lossy data format such as JPG for thumbnails. Another good alternative is WebP. Also, PNGs can be used if we need any crisp images, but we can just use JPG for that as well.</div><div class="note"><p>Google's WebP format is supported across most browsers and platforms these days.</div></div><div class="box"><div class="content"><h4 id="bibliography-for-tinder-system-design">[2.1.3] Bibliography for Tinder system design</h4><details><summary>Bibliography for Tinder Design</summary><small><small><p>AAA (computer security). (2022). Wikipedia. Available from https://en.wikipedia.org/w/index.php?title=AAA_(computer_security)&amp;oldid=1068643459 [Accessed 1 July 2022].<p>Designing Tinder - High Scalability -. (no date). Available from http://highscalability.com/blog/2022/1/17/designing-tinder.html [Accessed 1 July 2022].<p>Geometry on the Sphere: Google\x27s S2 Library. (no date). Available from https://docs.google.com/presentation/d/1Hl4KapfAENAOf4gv-pSngKwvS_jwNVHRPZTTDzXXn6Q [Accessed 1 July 2022].<p>GKQuadtree | Apple Developer Documentation. (no date). Available from https://developer.apple.com/documentation/gameplaykit/gkquadtree [Accessed 1 July 2022].<p>Li, X. (2019). Geosharded Recommendations Part 2: Architecture. Tinder Tech Blog. Available from https://medium.com/tinder/geosharded-recommendations-part-2-architecture-3396a8a7efb [Accessed 1 July 2022].<p>Pareto principle. (2022). Wikipedia. Available from https://en.wikipedia.org/w/index.php?title=Pareto_principle&amp;oldid=1095743858 [Accessed 1 July 2022].<p>Password Storage - OWASP Cheat Sheet Series. (no date). Available from https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html#pbkdf2 [Accessed 1 July 2022].<p>Passwordless authentication. (2022). Wikipedia. Available from https://en.wikipedia.org/w/index.php?title=Passwordless_authentication&amp;oldid=1082243741 [Accessed 1 July 2022].<p>Power law. (2022). Wikipedia. Available from https://en.wikipedia.org/w/index.php?title=Power_law&amp;oldid=1091370904 [Accessed 1 July 2022].<p>Ren, F. (2019). Geosharded Recommendations Part 1: Sharding Approach. Tinder Tech Blog. Available from https://medium.com/tinder/geosharded-recommendations-part-1-sharding-approach-d5d54e0ec77a [Accessed 1 July 2022].<p>Role-based access control. (2022). Wikipedia. Available from https://en.wikipedia.org/w/index.php?title=Role-based_access_control&amp;oldid=1094481919 [Accessed 1 July 2022].<p>S2 Geometry. (no date). S2Geometry. Available from http://s2geometry.io/ [Accessed 1 July 2022].<p>Thomson, D. (2019). Geosharded Recommendations Part 3: Consistency. Tinder Tech Blog. Available from https://medium.com/tinder/geosharded-recommendations-part-3-consistency-2d2cb2f0594b [Accessed 1 July 2022].<p>Tran, J. (2019). Which Image Format for Making Smaller File Size? GretaThemes. Available from https://gretathemes.com/image-format-for-smaller-file-size/ [Accessed 1 July 2022].<p>UV mapping. (2022). Wikipedia. Available from https://en.wikipedia.org/w/index.php?title=UV_mapping&amp;oldid=1094514074 [Accessed 1 July 2022].<p>WebP Compression Study. (no date). Google Developers. Available from https://developers.google.com/speed/webp/docs/webp_study [Accessed 1 July 2022].<p>What is a Quadtree &amp; how is it used in location-based services? (no date). Available from https://www.educative.io/answers/what-is-a-quadtree-how-is-it-used-in-location-based-services [Accessed 1 July 2022].<p>Whited, S. (no date). Best practices for password hashing and storage. Internet Engineering Task Force. Available from https://datatracker.ietf.org/doc/draft-ietf-kitten-password-storage-04 [Accessed 1 July 2022].</small></small></details></div><div class="note"></div></div><div class="box"><div class="content"><hr><h3 id="leetcode-hacker-rank-system-design">[2.2] Leetcode / Hacker rank system design</h3></div><div class="note"><hr></div></div><div class="box"><div class="content"><a href="images/system-design-leetcode.png"target="_blank"rel="noopener noreferrer"><img alt="Leetcode Design, contain a diagram with arrows pointing to services"src="images/system-design-leetcode.png"style="max-width:100%"></a></div><div class="note"><p>I'm up for suggestions for this as well.<p><span class="yellow-status">in progress</span></div></div><div class="box"><div class="content"><h4 id="code-execution">[2.2.1] Code execution</h4></div><div class="note"></div></div><div class="box"><div class="content"><p>Sandboxed code execution is one of the main features of an online judge platforms.<ul><li><p>Need to be isolated from the rest of the system - this is because some executed code can be malicious.<ul><li><p>Would be a good idea to disable everything except stdin/stdout as input output mechanisms.<li><p>No access to internet is a must as that opens us up to more risks.</ul><li><p>Need to be flexible enough to run different supported compilers and interpreters.<li><p>In case of endless loops or the solution taking too much time we need to timeout.<li><p>Need to be able to handle scale of increased load to judge system.<ul><li><p>Either by queuing input or rejecting.<li><p>Can also dynamically scale with more nodes if needed.</ul></ul></div><div class="note"></div></div><div class="box"><div class="content"><h5 id="solution-a-docker-containers-on-lambdas-serverless">[2.2.1.1] Solution A: Docker containers on lambdas (serverless)</h5><ul><li><p>👍 Can scale up with more functions, of course that would also cost more.<li><p>👍 Less hassle to set up if you wish to go this route.<li><p>👍 Built in timeout logic.<li><p>👍 Paid only for usage when lambdas are run.</ul></div><div class="note"><p>It is almost as if lambdas were built for this. 😏</div></div><div class="box"><div class="content"><h5 id="solution-b-servers-that-take-work-from-a-queue-spin-up-docker-containers">[2.2.1.2] Solution B: Servers that take work from a queue spin up docker containers</h5><ul><li><p>👍 Fixed cost if sufficient servers are present.<li><p>👎 Same cost even if there are no usage.<li><p>👎 Cannot scale up as needed and more servers need to be added manually.<li><p>👎 Need to come up with services that can take work from a queue and spin up docker containers<li><p>👎 Server CPU/RAM monitoring is required to see that a container does not use too many resources.<li><p>👎 Need to implement timing out logic.</ul></div><div class="note"></div></div><div class="box"><div class="content"><h4 id="plagiarism-detection">[2.2.2] Plagiarism detection</h4></div><div class="note"></div></div><div class="box"><div class="content"><p>It is possible to create an online judge system without a plagiarism detection method. However, it is needed if we want to run contests. Contestants will cheat and there should be a way to detect it.<h5 id="different-forms-of-cheating">[2.2.2.1] Different forms of cheating</h5></div><div class="note"></div></div><div class="box"><div class="content"><ul><li><p>A: Just copying and pasting same answer<li><p>B: Copying and pasting same answer with different comments, whitespace changes.<li><p>C: Variable name, function name changes<li><p>D: Combination of both B and C.<li><p>E: Partial similarities + D.</ul></div><div class="note"><p>If you rewrite it as a complete different algorithm, it is not possible detect. However, this is sufficient for what we need to do. Even coming up with a way to detect A or B type of cheating would be useful.</div></div><div class="box"><div class="content"><h5 id="cheat-detection-process">[2.2.2.2] Cheat detection process</h5></div><div class="note"></div></div><div class="box"><div class="content"><p>I would implement cheat detection as a multistep process. We can have coordinated lambda executions to achieve this. There are few ways to implement cheat detection process.<h6 id="solution-a-lambdas-with-step-function-execution">[2.2.2.2.1] Solution A: Lambdas with step function execution</h6><ul><li><p>👍 Steps are coordinated using step functions.<li><p>👍 Can scale number of lambdas needed.</ul><h6 id="solution-b-coordinated-work-in-static-number-of-nodes">[2.2.2.2.2] Solution B: Coordinated work in static number of nodes</h6><ul><li><p>👎 Will require implementation for coordination<li><p>👎 Scale up require manually adding servers to the pool.</ul></div><div class="note"></div></div><div class="box"><div class="content"><h4 id="bibliography-for-leetcode-design">[2.2.3] Bibliography for Leetcode design</h4></div><div class="note"></div></div><div class="box"><div class="content"><details><summary>Bibliography for Leetcode / Hacker rank system design</summary><small><small><p>AWS Step Functions | Serverless Visual Workflows | Amazon Web Services. (no date). Amazon Web Services, Inc. Available from https://aws.amazon.com/step-functions/ [Accessed 3 July 2022].<p>AWS Step Functions FAQs | Serverless Microservice Orchestration | Amazon Web Services. (no date). Amazon Web Services, Inc. Available from https://aws.amazon.com/step-functions/faqs/ [Accessed 3 July 2022].<p>Bag-of-words model. (2022). Wikipedia. Available from https://en.wikipedia.org/w/index.php?title=Bag-of-words_model&amp;oldid=1087243933 [Accessed 2 July 2022].<p>Belkhouche, B., Nix, A. and Hassell, J. (2004). Plagiarism detection in software designs. Proceedings of the 42nd annual Southeast regional conference on - ACM-SE 42. 2004. Huntsville, Alabama: ACM Press, 207. Available from https://doi.org/10.1145/986537.986585 [Accessed 2 July 2022].<p>Cosma, G. and Joy, M. (2012). An Approach to Source-Code Plagiarism Detection and Investigation Using Latent Semantic Analysis. IEEE Transactions on Computers, 61 (3), 379–394. Available from https://doi.org/10.1109/TC.2011.223.<p>Designing Online Judge or Leetcode. (2020). TianPan.co. Available from https://tianpan.co/notes/243-designing-online-judge-or-leetcode [Accessed 2 July 2022].<p>Getting Started with ssdeep. (no date). Available from https://ssdeep-project.github.io/ssdeep/usage.html [Accessed 2 July 2022].<p>Introduction to Document Similarity with Elasticsearch. (no date). Capsicum. Available from https://rebeccabilbro.github.io/intro-doc-similarity-with-elasticsearch/ [Accessed 2 July 2022].<p>Okapi BM25. (2022). Wikipedia. Available from https://en.wikipedia.org/w/index.php?title=Okapi_BM25&amp;oldid=1082128332 [Accessed 2 July 2022].<p>Plagiarism detection in your submitted code. (no date). HackerRank Support Center. Available from https://support.hackerrank.com/hc/en-us/articles/360018050274-Plagiarism-detection-in-your-submitted-code [Accessed 2 July 2022].<p>Tresnawati, D., Syaichu R, A., and Kuspriyanto. (2012). Plagiarism Detection System Design for Programming Assignment in Virtual Classroom based on Moodle. Procedia - Social and Behavioral Sciences, 67, 114–122. Available from https://doi.org/10.1016/j.sbspro.2012.11.312.</small></small></details></div><div class="note"></div></div><div class="box"><div class="content"></div><div class="note"></div></div><div class="box"><div class="content"><hr><h2 id="subsystems-and-utility-systems-samples">[3] Subsystems and utility systems samples</h2></div><div class="note"><hr></div></div><div class="box"><div class="content"><p>In this section we can see some samples of lower-level utilities and subsystems that these other systems either assumes to exist or utilize.</div><div class="note"><p>Mostly for high level system design you only see one layer of the onion or one slice of the cake.</div></div><div class="box"><div class="content"><hr><h3 id="vm-cluster">[3.1] VM Cluster</h3></div><div class="note"><hr></div></div><div class="box"><div class="content"><p>In this example I explore how one can spin up custom VMs using bare metal servers.</div><div class="note"><p><span class="red-status">not started</span></div></div><div class="box"><div class="content"><hr><h3 id="lambdas-on-top-of-vm-cluster">[3.2] Lambdas on top of VM Cluster</h3></div><div class="note"><hr></div></div><div class="box"><div class="content"><p>Given that we got VM clusters how do we come up with lambdas.</div><div class="note"><p><span class="red-status">not started</span></div></div><div class="box"><div class="content"><hr><h3 id="distributed-queue">[3.3] Distributed queue</h3></div><div class="note"><hr></div></div><div class="box"><div class="content"><p>Distributed queues are an essential subsystem that can be used as a component of many system designs. There are two obvious designs for distributed queues publisher-subscriber style and poll style. Additionally, priority queue specialization for queues exists. We will look at standard publisher-subscriber style queue.<p>First, let’s assume the scenario of implementing a single node queue. What would be the features of this single node queue system.</div><div class="note"><p><span class="yellow-status">in progress</span></div></div><div class="box"><div class="content"><h4 id="single-node-queue-implementation">[3.3.1] Single node queue implementation</h4></div><div class="note"></div></div><div class="box"><div class="content"><ul><li><p>Any node can reach this node and pass in a message to a topic.<li><p>Some binary protocol is used to communicate with the queue node.<li><p>Once messages are received, it is immediately written to an on-disk format with micro batching (n items are written to a file).<li><p>Certain threads are used to handle incoming messages this is then passed to I/O thread (s) to write to on-disk format (we can use an internal queue for that).<li><p>Few more threads can be used to reading from on-disk format and delivering message to destination.<li><p>Message delivery will be based on the topic.<li><p>We allow configuration of message handling threads, I/O write threads and I/O read threads and message delivery threads.<li><p>Ideally, we will use lightweight / green threads / coroutines for all above threads and consume CPU_COUNT - x number of real OS threads. Coroutines can be implemented using duff&#x27;s devices and CPU register snapshots. For distributed application we can use something that is built-in to the language or a library to achieve this.<li><p>We can retry to deliver a message for a configurable number of times and then add that to another instance of queue. (In this single node example, it will be another node). This would be a dead letter queue. And with this now we have a nice chicken egg problem of dead letter queue. But we do not need to worry too much as dead letter queue will be the destination for things that we cannot deliver.<li><p>We can probably use a different directory for failed to deliver messages that we can retry.<li><p>Exponential backoff can be used to retry, so we avoid thundering herd problem.<li><p>Now for a single node implementation (or two nodes if you count dead letter queue node) we will have nothing to do (or nothing can be done) if dead letter queue itself is not available. We can also consider modelling dead letter queue as a special topic as well.</ul></div><div class="note"></div></div><div class="box"><div class="content"><h4 id="multi-node-implementation">[3.3.2] Multi-node implementation</h4></div><div class="note"></div></div><div class="box"><div class="content"><a href="images/subsystem-design-distributed-queue-pub-sub.png"target="_blank"rel="noopener noreferrer"><img alt="Distributed Queue Design"src="images/subsystem-design-distributed-queue-pub-sub.png"style="max-width:100%"></a></div><div class="note"></div></div><div class="box"><div class="content"><hr><h3 id="distributed-monitoring-and-paging">[3.4] Distributed monitoring and paging</h3></div><div class="note"><hr></div></div><div class="box"><div class="content"><p>Monitoring and paging for high level systems.</div><div class="note"><p><span class="red-status">not started</span></div></div><div class="box"><div class="content"><hr><h3 id="distributed-storage-file-system">[3.5] Distributed storage / file system</h3></div><div class="note"><hr></div></div><div class="box"><div class="content"><p>This is to store images.</div><div class="note"><p><span class="red-status">not started</span></div></div><div class="box"><div class="content"><hr><h3 id="in-memory-cache">[3.6] In memory cache</h3></div><div class="note"><hr></div></div><div class="box"><div class="content"><p>In memory caches reduce latency when accessing databases and avoid recomputing values. This is an essential component of any system design.</div><div class="note"><p><span class="red-status">not started</span></div></div><div class="box"><div class="content"><hr><h2 id="components">[4] Components</h2></div><div class="note"><hr></div></div><div class="box"><div class="content"><h3 id="services-and-related-components">[4.1] Services and related components</h3></div><div class="note"></div></div><div class="box"><div class="content"><h4 id="service">[4.1.1] Service</h4><img alt="Three squares on top of each other with service written in the middle"src="images/sdt-service.png"style="max-width:100%"><p>This is used for microservice components. Reason why I put multiple boxes here is to indicate that there are more than one service instance running.<p>Load balancing for this service is assumed to be dealt with. I do not think there's a reason to draw load balancers, but you can draw it if you wish.</div><div class="note"><p>This is different from function/lambda component.</div></div><div class="box"><div class="content"><h3 id="algorithms-and-data-structures">[4.2] Algorithms and data structures</h3></div><div class="note"></div></div><div class="box"><div class="content"><h4 id="quad-tree">[4.2.1] Quad tree</h4><img alt="3 Squares with quad-tree breakdown"src="images/sdt-quad-tree.png"style="max-width:100%"><p>Quad tree allows you to map a section to four subsections. One good use case is mapping a geographical area.</div><div class="note"></div></div><div class="box"><div class="content"><h3 id="utilities">[4.3] Utilities</h3></div><div class="note"></div></div><div class="box"><div class="content"><h4 id="pros-cons-box">[4.3.1] Pros-Cons Box</h4><img alt="Table with pros and cons specified as titles"src="images/sdt-pro-con.png"style="max-width:100%"><p>This is rather simple table to list pros and cons. Use it when you want to compare different technologies of decisions.</div><div class="note"><p>Pro - it got pros. Con - it got cons.</div></div></div></div><script>!function(){const s=document.querySelector("#btn-toggle"),t=document.querySelector("#theme-link"),e="jadogg.github.io/theme",a='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-brightness-high" viewBox="0 0 16 16">\n  <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>\n</svg>',l='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-moon-fill" viewBox="0 0 16 16">\n  <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>\n</svg>';var i=localStorage.getItem(e);"/assets/style.min.css"!==i&&"/assets/style.light.min.css"!==i||(t.href=i,s.innerHTML="/assets/style.min.css"===i?a:l),s.addEventListener("click",function(){"/assets/style.min.css"===t.getAttribute("href")?(t.href="/assets/style.light.min.css",localStorage.setItem(e,"/assets/style.light.min.css"),s.innerHTML=l):(t.href="/assets/style.min.css",localStorage.setItem(e,"/assets/style.min.css"),s.innerHTML=a)})}()</script>